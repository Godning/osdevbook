# Preface

Translating

http://www.brokenthorn.com/Resources/OSDev0.html

#介绍

这是一本关系计算机和操作系统的书，旨在通过在一步步从无到有构建一个操作系统的过程中，体会操作系统的结构、概念以及系统层的编程。

同时，本书也想通过细致的介绍，尽量做到让读者能够了解到操作系统和计算机系统中的每一个细节。

再开始之前，我们需要先了解一些关于编程语言的重要知识，同时还需要达到熟练的运用这些知识解决问题的水准。当然，有一些东西其实也就是嵌入式平台和系统级编程的时候会使用到的知识。

本书采用C语言和x86汇编语言。读者需要具备一定的C语言和x86汇编语言基础，同时还能灵活的使用这两门语言。

#C语言

我们假定读者已经具备了一定的C语言编程基础，这里就简单地阐述一些C语言在操作系统开发中的一些相当重要的东西。

##内核空间中的C语言

###16位和32位的C语言

在开始操作系统开发的时候，你肯定会不知所措。在计算机被唤醒的时候，CPU运行在16位的“实模式”下，这种模式下是无法运行32位的C编译器生成的程序的。也就是说，想要开发一个16位的操作系统，就必须得使用支持16位的C编译器。同样，如果想要开发一个32位的操作系统，就得使用32位的C编译器了。

本书中的操作系统是构建在32位的平台上的，因此，书中采用32位的C编译器。

###C语言和可执行文件

面对C语言的第一个问题就是，C语言无法直接通过编译得到一个平坦的二进制程序。平坦的二进制程序是指程序的入口（也就是main函数）始终在可执行文件的第一个字节开始。不对，我们关注这个问题有什么用？

这得从以前的DOS下的COM程序说起。DOS下的COM程序就是一个平坦的可执行文件，这种文件没有任何过多的附加信息，仅仅由程序的指令和一些程序内部需要使用到的数据组成。执行这样的程序的时候，只需要告诉CPU从这个文件的开头读取指令，一步步执行就可以了。这样执行一个程序就变的非常简单了，只要把整个文件夹在到内存，从文件开头一步步往下执行就可以了。当我们的机器开机的时候，整个计算机是交给BIOS中的ROM里的程序控制着的，这时候它是不知道要运行什么程序的，也不知道怎么运行。所以呢，人们干脆把它设计成不需要关心程序文件的结构的BIOS，反正只需要从磁盘中的一个固定位置读取一个固定长度的程序，加载到内存里，然后从程序的最开始读取指令执行就行了。这个固定的位置就是引导扇区，那个固定的程序就被称为BootLoader，这个固定的长度就是512字节。

所以，从上面的描述来说，Bootloader是没办法用C语言来编写的，因为C语言编译器生成的可执行文件是有一定格式的，它没法生成这种平坦的可执行文件。没有选择，只能使用汇编语言来做这个第一阶段的程序。



